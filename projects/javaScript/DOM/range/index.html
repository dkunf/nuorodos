<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Range</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="container">
      <div class="range-element">
        <div class="rail"></div>
        <div class="runner">
          <div class="needle"></div>
        </div>
      </div>

      <div class="ruler">
        <canvas class="canvas" width="1000" height="200"></canvas>
      </div>
    </div>
    <!-- actually range slider is needed when 
      you want to see quickly results of using some very different values.
    Entering from keyboard takes more efforts and time,
    unless it's arrows, but arrows can change range insignifficantly
    while slider can be moved very significantly.
    Maybe 2d range is best for picking colors, right?
    because it's very visual and very quick to choose what you want.
      
    so to make sense using range slider:
    1: range changes are significant (otherwise arrow keys)
    2: you need to visualize effect of changing values quickly

    what if i use it applying a lot of css styles to some group 
    of elements and seeing effect of doing it immediately?????
for example margin,padding,height,width.

then flex with all flex options 
then grid with all grid options 

and i don't need to know which ones applied until i find suittable one :)
same with colors, shaddows, animation params etc.....

border-radii are tricky, gradients
-->
    <script>
      //this runner is not descrete,but continuos
      //goal is to make runner run to clicked coordinates
      const rangeEl = document.querySelector(".range-element");
      const rail = document.querySelector(".rail");
      const runner = document.querySelector(".runner");
      let needle = document.querySelector(".needle");
      let rulerContainer = document.querySelector(".ruler");
      let canvas = document.querySelector(".canvas");

      // it moves now
      rangeEl.addEventListener("click", moveToClickedCoord);
      document.addEventListener("keydown", keyHandler);

      logAllRects();

      function keyHandler(event) {
        let rangeRect = rangeEl.getBoundingClientRect();
        let leftEdgeOfRange = rangeRect.left;
        let runnerRect = runner.getBoundingClientRect();
        let runnerLocalCoordX = runnerRect.left - leftEdgeOfRange;
        if (event.key === "ArrowRight") {
          if (runnerRect.right < rangeRect.right) {
            runner.style.left = Math.round(runnerLocalCoordX + 1) + "px";
          }
        }
        if (event.key === "ArrowLeft") {
          if (runnerLocalCoordX >= 0.5)
            runner.style.left = Math.round(runnerLocalCoordX - 1) + "px";
        }
      }

      //now i want to add ruler or some reference to data
      //i am thinking of precision of 1px, can i do it like
      //on the slankmatis?
      function moveToClickedCoord(event) {
        //we switch to local coords by minus left edge of range
        let rangeRect = rangeEl.getBoundingClientRect();
        let runnerRect = runner.getBoundingClientRect();
        let clickedX = event.clientX;
        let halfRunner = Math.round(runnerRect.width / 2);

        //left to the very edge
        if (clickedX < rangeRect.left + halfRunner) {
          runner.style.left = "0";
          return;
        }
        //right to the very edge
        if (clickedX > rangeRect.right - halfRunner) {
          runner.style.left = rangeRect.width - 2 * halfRunner + "px";

          return;
        }

        runner.style.left = clickedX - rangeRect.left - halfRunner + "px";
      }

      function drawRuler(arr = [1, 2, 3, 4, 5, 6, 7, 8, 9]) {}

      function logAllRects() {
        let rangeRect = rangeEl.getBoundingClientRect();
        let railRect = rail.getBoundingClientRect();
        let runnerRect = runner.getBoundingClientRect();
        let needleRect = needle.getBoundingClientRect();
        let rulerContainerRect = rulerContainer.getBoundingClientRect();
        let canvasRect = canvas.getBoundingClientRect();

        let rectangles = [
          rangeRect,
          railRect,
          runnerRect,
          needleRect,
          rulerContainerRect,
          canvasRect,
        ];

        console.log(`

        rangeRect, railRect, runnerRect, needleRect, rulerContainerRect, canvasRect

        leftSides:
        ${rectangles.map((r) => r.left)}
        rightSides:
        ${rectangles.map((r) => r.right)}
        widths:
        ${rectangles.map((r) => r.width)}
        `);
      }
    </script>
  </body>
</html>
